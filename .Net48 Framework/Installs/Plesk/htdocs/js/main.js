var debugMode=true;var geocoder;var map;var skipRestyling=false;var dialogHTML="";window.default_confirm=window.confirm;window.default_alert=window.alert;window.alert=function(b,c){if(b===undefined){return window.default_alert(b)}try{bootbox.alert({title:c,message:b})}catch(a){return window.default_alert(b)}};window.confirm=function(b,c){if(c===undefined){return window.default_confirm(b)}try{bootbox.confirm(b,function(d){if(d===true){c()}})}catch(a){return window.default_confirm(b)}};function Left(a,b){if(b<=0){return""}else{if(b>String(a).length){return a}else{return String(a).substring(0,b)}}}function LogGoogleEvent(b,c,a){ga("set","checkProtocolTask",function(){});ga("send",{hitType:"event",eventCategory:b,eventAction:c,eventLabel:a})}function Right(b,c){if(c<=0){return""}else{if(c>String(b).length){return b}else{var a=String(b).length;return String(b).substring(a,a-c)}}}function debugMsg(a){if(debugMode===true){return a}else{return""}}function changeDashYear(){if($("#changeYearM").length===0){var b=new Date().getFullYear();var d=new Date().getFullYear(),a=d+2;d=d-2;a=a-2;var f=d;var e='<div id="changeYearM" title="Change Year">';e+='<select id="yearSelect" class="selectEntry">';for(var c=d;c<=a;c++){f=c-1;e+='<option value="'+f+'">'+f+"</option>"}e+='<option value="'+b+'">'+b+"</option>";e+="</select>";e+="</div>";$("body").append(e);restyleFormElements("#changeYearM")}openModal("changeYearM",280,140,'<input type="button" onclick="changeDashYearNow();" class="btn btn-primary" value="Change" />')}function changeDashYearNow(){var a="";if(document.location.href.indexOf("?")>=0){a=document.location.href.split("?")[0]}else{a=document.location.href}document.location.href=a+"?Year="+$("#yearSelect").val()}function getIdentity(){var d=[];var a="192839093455102372";for(var b=0;b<16;b++){d[b]=a.substr(Math.floor(Math.random()*16),1)}var c=d.join("");return Left(c,15)}function loadHelp(){openModal("helpDialog",300,270)}function checkEnter(b){var a;if(window.event){a=window.event.keyCode}else{a=b.which}return(a!==13)}function WYSIWYGFunctions(b,a,c){var d="";if(c===true){d="?Editor=TinyMCE"}if(b==="newestcontent"){if($("#newestcontent").length===0){$("body").append('<div id="newestcontent" class="dynamicFunctionDiv" title="Insert Newest Content"><iframe src="'+config.imageBase+"js/newest_features.aspx"+d+'" name="newestinsertframe" id="newestinsertframe" width="320" height="110" frameborder="0"></iframe></div>')}openModal("newestcontent",340,220,'<input type="button" onclick="newestinsertframe.insertFunction();" class="btn btn-primary" value="Insert" />')}if(b==="dynamicfunctions"){if($("#dynamicfunctions").length===0){$("body").append('<div id="dynamicfunctions" class="dynamicFunctionDiv" title="Insert Dynamic Content"><iframe src="'+config.imageBase+"js/insert_functions.aspx"+d+'" name="dynamicinsertframe" id="dynamicinsertframe" width="320" height="110" frameborder="0"></iframe></div>')}openModal("dynamicfunctions",340,220,'<input type="button" onclick="dynamicinsertframe.insertFunction();" class="btn btn-primary" value="Insert" />')}if(b==="rssfeed"){if($("#rssfeed").length===0){$("body").append('<div id="rssfeed" class="dynamicFunctionDiv" title="Insert RSS Feed"><iframe src="'+config.imageBase+"js/rss_feed.aspx"+d+'" name="rssinsertframe" id="rssinsertframe" width="320" height="130" frameborder="0"></iframe></div>')}openModal("rssfeed",340,240,'<input type="button" onclick="rssinsertframe.insertRSS();" class="btn btn-primary" value="Insert" />')}}function openImageBrowser(){if($("#imgbrowser").length===0){$("body").append('<div id="imgbrowser" title="Browse / Upload Images"><iframe src="'+config.imageBase+'spadmin/ImageManager/default.aspx" width="650" height="450"></iframe></div>')}openModal("imgbrowser",300,400)}function showResults(a,b){if($("#PollOptions"+a).is(":hidden")===true){$("#PollOptions"+a).show();$("#PollResults"+a).hide();$("#resultsLink"+a).html("View Results")}else{$.ajax({type:"GET",url:config.imageBase+"api/polls/results?PollID="+b,dataType:"json",contentType:"application/json",error:function(c){$("#PollResults"+a).hide();alert("You must be logged in or do not have access to view this poll.")},success:function(c){var d="";$.each(c,function(e){d+=c[e].PollOption+"<br/>";d+='<div class="progress">';d+='<div class="progress-bar" role="progressbar" aria-valuenow="'+c[e].Percentage+'" aria-valuemin="0" aria-valuemax="100" style="width: '+c[e].Percentage+'%;">'+c[e].Percentage+"%</div>";d+="</div>"});$("#PollResults"+a).css("padding","10px");$("#PollResults"+a).html(d)}});$("#PollOptions"+a).hide();$("#PollResults"+a).show();$("#resultsLink"+a).html("View Poll")}}function castVote(d,c,a,b){var e=new Object();e.PollID=d;e.OptionID=c;e.PortalID=a;$.ajax({type:"POST",data:JSON.stringify(e),url:config.imageBase+"api/polls/vote",dataType:"json",contentType:"application/json",error:function(f){alert("You must be logged into our system to cast a vote.");document.cookie="returnUrl="+config.siteBase+"poll/"+d;document.location.href=config.siteBase+"login.aspx"},success:function(f){showResults(b,d)}})}function customFormValidator(a,b){if(b.Value===""){if($("#error"+a.getAttribute("id")).length===0){var c='<div class="alert alert-danger" role="alert">One or more fields are required.</div>';$("#ErrorMessage").html(c)}b.IsValid=false}else{if($("#error"+a.getAttribute("id")).length>0){$("#error"+a.getAttribute("id")).remove()}b.IsValid=true}}function saveFavorite(c,b,a){$.ajax({url:config.siteBase+"favorites_add.aspx?CatID="+c+"&ModuleID="+b+"&PageURL="+a,error:function(f,d,e){alert("There has been an error saving favorite.")},success:function(d){$("#AddFavoritesMsg").html(d);try{$(":input[type='button'],:input[type='submit']").button()}catch(f){return false}}})}function openModal(b,d,a,e){if($("#"+b+"modal").length===0){dialogHTML=$("#"+b).html();var c="";c+='<div class="modal fade" id="'+b+'modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">';c+='  <div class="modal-dialog modal-dialog-centered" style="width: '+(d+30)+'px;" role="document">';c+='    <div class="modal-content">';c+='      <div class="modal-header">';c+='        <h5 class="modal-title" id="myModalLabel">'+$("#"+b).attr("title")+"</h5>";c+='        <button type="button" class="close" data-dismiss="modal" aria-label="Close">';c+='          <span aria-hidden="true">&times;</span>';c+="        </button>";c+="      </div>";c+='      <div class="modal-body" style="height: '+(a-80)+'px;">';c+="        "+dialogHTML;c+="      </div>";c+='      <div class="modal-footer">';c+='      <button type="button" class="btn btn-secondary" data-dismiss="'+b+'modal" onclick="closeDialog(\''+b+"')\">Close</button>";if(e!==undefined){c+="      "+e}c+="      </div>";c+="    </div>";c+="  </div>";c+="</div>";$("#"+b).html(c);$("#"+b).show();$("#"+b+"modal").modal();$("#"+b+"modal").on("hidden.bs.modal",function(f){closeDialog(b)})}else{$("#"+b+"modal").modal("show")}return false}function openDialog(d,b,a,c){openModal(d,b,a,c);return false}function closeDialog(a){$("#"+a+"modal").modal("hide");return false}function adminLoginDialog(){$(document).ready(function(){try{$("#LoginButton").addClass("btn btn-primary");var b=$("#LoginButton").clone().wrap("<div>").parent().html();$("#LoginButton").remove();openModal("LoginDiv",320,310,b);if($("#LoginButton").length===0){$("#LoginDiv .modal-footer").append(b)}}catch(a){return false}})}function fixMenus(){var a='<li class="nav-item dropdown">';a+='<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">';a+="Member Menu";a+="</a>";a+='<div class="dropdown-menu" aria-labelledby="navbarDropdown">';a+="</div>";a+="</li>";if(window.innerWidth>768){$(".sitemenu3v").show();$("h4:contains('Member Menu')").show();$(".sitemenu1 .nav .dropdown").remove();$(".sitemenu3v .nav li").each(function(b){$(this).find("a").attr("class","nav-link")})}else{if($(".sitemenu3v .nav li").length>0){$(".sitemenu1 .nav").append(a);$(".sitemenu3v .nav li").each(function(b){$(this).find("a").attr("class","dropdown-item").clone().appendTo(".sitemenu1 .nav .dropdown .dropdown-menu")});$(".sitemenu3v").hide();$("h4:contains('Member Menu')").hide()}}}$(document).ready(function(){fixMenus();$(window).on("resize",function(){fixMenus()});restyleGridView("#ManageGridView");if(skipRestyling===false){restyleFormElements()}$(":input[type='text'],:input[type='password'],textarea").not(".ignore").each(function(){$(this).addClass("form-control");$(this).removeClass("textEntry");$(this).removeClass("textareaEntry")});$(".GridViewStyle :input[type='text']").each(function(){$(this).css("display","inline-block");$(this).css("width","auto")});$(":input[type='radio']").not(".ignore").each(function(){if($(this).attr("class")!=="ui-helper-hidden-accessible"){$(this).addClass("radio-inline");$(this).next("label").css("display","inline-block");$(this).next("label").css("margin-left","10px")}});$("input[type='checkbox']").not(".ignore").each(function(){if($(this).attr("class")!=="ui-helper-hidden-accessible"){$(this).addClass("checkbox-inline");$(this).css("height","16px");$(this).css("width","16px");$(this).css("margin","0");$(this).next("label").css("display","inline-block");$(this).next("label").css("margin-left","8px")}});$(".phoneEntry").each(function(){$(this).wrap('<div class="input-group"></div>');$('<div class="input-group-btn"><button onclick="openPhone(\''+$(this).val()+'\');" type="button" class="btn btn-default" aria-label="Left Align"><span class="glyphicon glyphicon-earphone"></span></button></div>').insertAfter(this)});$(".TableTitle td").addClass("well");$(".TableTitle td").css("padding","5px 0 5px 5px");$(":input[type='button'],:input[type='submit']").addClass("btn btn-default");if(skipRestyling===false){$("select").not(".ignore").each(function(){$(this).addClass("form-control");$(this).removeClass("selectEntry")});$(".GridViewStyle select").not(".ignore").each(function(){$(this).css("display","inline-block");$(this).css("width","auto")});$(".inlineBlock").each(function(){$(this).css("display","inline-block");$(this).css("width","auto")});$(".combo_common_nowidth").each(function(){$(this).css("display","inline-block");$(this).css("width","auto")});$(".inline-block").each(function(){$(this).css("display","inline-block")})}if($(".product-slider").length>0){$(".product-slider").slick({slidesToShow:2,slidesToScroll:1,autoplay:true,autoplaySpeed:2500,responsive:[{breakpoint:1024,settings:{slidesToShow:2,slidesToScroll:2,infinite:true,dots:true}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]})}$(".pagecontent").css("top",$("nav.navbar").height()+20)});function openPhone(a){if($("#dialNumberDiv").length===0){$("body").append('<div id="dialNumberDiv" title="Dial Number"></div>');$("#dialNumberDiv").append('<iframe style="width:100%; height: 450px;" id="UserSearchFrame" src="../twilio/softphone.aspx?Number='+a+'" frameborder="0" />')}openModal("dialNumberDiv",350,560)}function restyleGridView(a){var b="";if($(a+" caption").html()!==null){b=$(a+" caption").html()}$(a).addClass("table table-striped table-bordered");if(b!==undefined){if(b!==""){$(a+" caption").remove();$(a).parent().prepend("<div>"+b+"</div>")}}$(a+" tr th").css("white-space","nowrap");$(a+" tr th a").css("display","inline-block");$(a+" tr th a").css("width","100%");$(a+" tr th a").css("color","#000000");$(a+" tr th a").append('<i class="fa fa-arrows-v" style="margin-left:20px;"></i>')}function restyleFormElements(a){if(a!==null){a=a+" "}else{a=""}$(a+".selectEntry").each(function(){$(this).addClass("form-control")});$(".inline-block").each(function(){$(this).css("display","inline-block")})}function showResultsChart(a){var b="";$.each(a,function(c){b+=a[c].PollOption+"<br/>";b+='<div class="progress">';b+='<div class="progress-bar" role="progressbar" aria-valuenow="'+a[c].Percentage+'" aria-valuemin="0" aria-valuemax="100" style="width: '+a[c].Percentage+'%;">'+a[c].Percentage+"%</div>";b+="</div>"});$("#PollResults").css("padding","10px");$("#PollResults").html(b)}function showResultsChartRandom(a){var b="";$.each(a,function(c){b+=a[c].PollOption+"<br/>";b+='<div class="progress">';b+='<div class="progress-bar" role="progressbar" aria-valuenow="'+a[c].Percentage+'" aria-valuemin="0" aria-valuemax="100" style="width: '+a[c].Percentage+'%;">'+a[c].Percentage+"%</div>";b+="</div>"});$("#PollResultsRandom").css("padding","10px");$("#PollResultsRandom").html(b)}function affiliateChart(a){var b="";$.each(a,function(c){b+=a[c].Level+"<br/>";b+='<div class="progress">';b+='<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="'+a[c].TotalEarnings+'" aria-valuemin="0" aria-valuemax="100" style="width: '+a[c].TotalEarnings+'px;">'+a[c].TotalEarnings+"</div>";b+='<div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="'+a[c].TotalVolume+'" aria-valuemin="0" aria-valuemax="100" style="width: '+(a[c].TotalVolume-a[c].TotalEarnings)+'px;">'+a[c].TotalVolume+"</div>";b+="</div>"});$("#affiliateChart").css("padding","10px");$("#affiliateChart").html(b)}function initMap(){var b=document.getElementById("idGoogleMapAddress").innerHTML;geocoder=new google.maps.Geocoder();var c=new google.maps.LatLng(-34.397,150.644);var a={zoom:12,center:c,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},navigationControl:true,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("idGoogleMapDiv"),a);if(geocoder){geocoder.geocode({address:b},function(f,e){if(e===google.maps.GeocoderStatus.OK){if(e!==google.maps.GeocoderStatus.ZERO_RESULTS){map.setCenter(f[0].geometry.location);var g=new google.maps.InfoWindow({content:"<b>"+b+"</b>",size:new google.maps.Size(150,50)});var d=new google.maps.Marker({position:f[0].geometry.location,map:map,title:b});google.maps.event.addListener(d,"click",function(){g.open(map,d)})}}})}}function geocodeAddress(b,c){var a=document.getElementById("idGoogleMapAddress");b.geocode({address:a},function(f,e){if(e==="OK"){c.setCenter(f[0].geometry.location);var d=new google.maps.Marker({map:c,position:f[0].geometry.location})}else{alert("Geocode was not successful for the following reason: "+e)}})};